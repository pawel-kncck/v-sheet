/* Basic reset and body styles */
* {
  box-sizing: border-box;
}

body {
  font-family: Arial, sans-serif;
  font-size: 13px;
  background-color: #ffffff;
  margin: 0;
  padding: 0px;
  color: #202124;
}

/* Main container using CSS Grid */
#spreadsheet-container {
  display: grid;
  grid-template-areas:
    'corner columns'
    'rows   cells';
  grid-template-columns: 46px 1fr; /* 50px for row headers */
  grid-template-rows: 24px 1fr; /* 25px for column headers */
  height: calc(100vh - 40px);
  overflow: hidden;
  /* Prevents text selection on headers during drag */
  user-select: none;
}

/* The top-left corner cell needs to be sticky */
#corner-cell {
  position: sticky;
  top: 0;
  left: 0;
  z-index: 3;
  /* border-right: 1px solid #d4d4d4; <-- REPLACED by .header-cell */
  /* border-bottom: 1px solid #d4d4d4; <-- REPLACED by .header-cell */

  /* ADDED: Add the missing top and left borders */
  border-top: 0.5px solid #dadce0;
  border-left: 0.5px solid #dadce0;
}

/* Base style for all header cells (A, B, 1, 2, etc.) */
.header-cell {
  font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif;
  font-size: 10px;
  background-color: #f8faf8;
  color: #444746;
  font-weight: normal;
  padding: 0px;
  /* border: 0.5px solid #999999; <-- REMOVED */
  text-align: center;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  /* Vertical and horizontal centering */
  display: flex;
  align-items: center;
  justify-content: center;

  /* ADDED: Apply only right and bottom borders */
  border-width: 0 0.5px 0.5px 0; /* Top, Right, Bottom, Left */
  border-style: solid;
  border-color: #c7c7c7;
}

/* Base style for data cells */
.cell {
  padding: 4px;
  /* border: 0.5px solid #dddddd; <-- REMOVED */
  background-color: #ffffff;
  text-align: left;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  position: relative; /* Needed for z-index to work correctly */

  /* ADDED: Apply only right and bottom borders */
  border-width: 0 0.5px 0.5px 0; /* Top, Right, Bottom, Left */
  border-style: solid;
  border-color: #dddddd;
}

/* Column Headers container */
#column-headers {
  grid-area: columns;
  display: grid;
  grid-auto-flow: column;
  /* grid-auto-columns: 100px; <-- REMOVED */
  overflow: hidden;
  z-index: 2;

  /* ADDED: Border for the top of the header row */
  border-top: 0.5px solid #dadce0;
}

/* Row Headers container */
#row-headers {
  grid-area: rows;
  display: grid;
  /* grid-auto-rows: 25px; <-- REMOVED */
  overflow: hidden;
  z-index: 1;

  /* ADDED: Border for the left of the header column */
  border-left: 0.5px solid #dadce0;
}

/* The main grid of cells */
#cell-grid {
  grid-area: cells;
  display: grid;
  /* grid-template-columns: repeat(26, 100px); <-- REMOVED */
  /* grid-template-rows: repeat(100, 25px); <-- REMOVED */
  overflow: auto;
  z-index: 0;

  /* ADDED: Borders for the top and left of the cell grid area */
  border-right: 0.5px solid #dddddd;
  border-bottom: 0.5px solid #dddddd;
}

/* --- NEW: Selection Styles --- */

/* Style for the currently active cell (thick blue border) */
.cell.selected {
  /* NOTE: This border will override the cell's default border */
  border: 1px solid #0e65eb;
  /* Use z-index to ensure the border is not overlapped by adjacent cells */
  z-index: 4;
  /* The padding needs to be reduced to account for the thicker border */
  padding: 2.5px;
}

/* --- NEW: Overlapping background styles --- */
/* These classes are added dynamically based on how many ranges overlap a cell */
.range-selected-1 {
  background-color: rgba(26, 115, 232, 0.1);
}
.range-selected-2 {
  background-color: rgba(26, 115, 232, 0.18);
}
.range-selected-3 {
  background-color: rgba(26, 115, 232, 0.26);
}
.range-selected-4 {
  background-color: rgba(26, 115, 232, 0.34);
}
/* Add more if you expect more overlaps */
.range-selected-5,
.range-selected-6,
.range-selected-7,
.range-selected-8 {
  background-color: rgba(26, 115, 232, 0.4);
}

/* --- NEW: Thin border for selection perimeters --- */
/* These rules still work perfectly with the new border model */
.range-border-top {
  border-top: 0.5px solid #1a73e8;
}
.range-border-right {
  border-right: 0.5px solid #1a73e8;
}
.range-border-bottom {
  border-bottom: 0.5px solid #1a73e8;
}
.range-border-left {
  border-left: 0.5px solid #1a73e8;
}

.header-highlight {
  background-color: #d2e3fc; /* A slightly darker blue for contrast */
  font-weight: bold;
}

#cell-editor {
  position: absolute;
  display: none;
  z-index: 5; /* Crucial: Must be higher than a selected cell's z-index */
  border: none;
  outline: none;
  background: transparent;
  font-family: Arial, sans-serif;
  font-size: 13px;
  padding: 4px;
  box-sizing: border-box;
}

/* Helper class to hide cell text during editing */
.cell.editing {
  color: transparent;
}
/* --- NEW: Drag-to-move styles --- */

/* Class to set the cursor on the grid container */
.grab-cursor {
  cursor: grab;
}

/* The ghost element for dragging */
#drag-ghost {
  position: absolute;
  border: 2px dashed #1a73e8;
  background-color: rgba(26, 115, 232, 0.05);
  z-index: 10;
  pointer-events: none; /* Allows mouse events to pass through to cells underneath */
}
